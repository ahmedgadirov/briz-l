version: "3.1"

intents:
  - symptom_eye_pain
  - symptom_blurry_vision
  - symptom_redness
  - concern_glasses
  - concern_cataract
  - concern_surgery_info
  - want_checkup
  - want_price_estimate
  - want_doctor_recommendation
  - urgent_issue
  - inform
  - greet
  - goodbye
  - thanks
  - affirm
  - deny
  - nlu_fallback
  - express_fear_surgery
  - express_fear_pain
  - express_fear_complications
  - ask_about_condition
  - ask_about_procedure
  - ask_more_details
  - ask_faq
  - search_medical_info
  - list_conditions
  - ask_address
  - ask_hours
  - bot_help
  - how_are_you

entities:
  - patient_concern
  - duration
  - doctor_name
  - phone_number
  - time
  - patient_name
  - age
  - medical_condition
  - medical_procedure


slots:
  patient_concern:
    type: text
    mappings:
      - type: from_text
        needs_correction: false
      - type: from_entity
        entity: patient_concern

  symptom_duration:
    type: text
    mappings:
      - type: from_entity
        entity: duration

  has_diagnosis:
    type: bool
    mappings:
      - type: from_intent
        value: true
        intent: affirm
      - type: from_intent
        value: false
        intent: deny

  preferred_doctor:
    type: text
    mappings:
      - type: from_entity
        entity: doctor_name

  patient_name:
    type: text
    mappings:
      - type: from_text
        conditions:
         - active_loop: booking_form
         
  phone_number:
    type: text
    mappings:
      - type: from_entity
        entity: phone_number
      - type: from_text
        conditions:
         - active_loop: booking_form
           requested_slot: phone_number

  preferred_time:
    type: text
    mappings:
      - type: from_entity
        entity: time
      - type: from_text
        conditions:
         - active_loop: booking_form
           requested_slot: preferred_time

  symptom_severity:
    type: text
    mappings:
      - type: from_text
        conditions:
         - active_loop: symptom_form
           requested_slot: symptom_severity

  conversation_stage:
    type: text
    initial_value: "greeting"
    mappings:
      - type: custom

  language:
    type: text
    initial_value: "az"
    mappings:
      - type: custom

  affects_daily_life:
    type: bool
    mappings:
      - type: from_intent
        value: true
        intent: affirm
        conditions:
         - active_loop: symptom_qualifier_form
      - type: from_intent
        value: false
        intent: deny
        conditions:
         - active_loop: symptom_qualifier_form

  symptom_type:
    type: text
    mappings:
      - type: from_text
        conditions:
         - active_loop: symptom_qualifier_form

  fallback_count:
    type: float
    mappings:
      - type: custom

  patient_emotion:
    type: text
    influence_conversation: true
    mappings:
      - type: custom

  urgency_level:
    type: categorical
    values:
      - routine
      - soon
      - urgent
      - emergency
    influence_conversation: true
    mappings:
      - type: custom
      
  patient_age:
    type: text
    mappings:
      - type: from_entity
        entity: age

  patient_profile:
    type: text
    mappings:
      - type: custom

  handoff_completed:
    type: bool
    mappings:
      - type: custom

  is_returning_patient:
    type: bool
    mappings:
      - type: custom

  education_topic:
    type: text
    mappings:
      - type: custom

  education_depth:
    type: float
    initial_value: 0
    mappings:
      - type: custom
  
  education_type:
    type: text
    mappings:
      - type: custom
  
  education_layer:
    type: text
    mappings:
      - type: custom
  
  detected_language:
    type: text
    initial_value: "az"
    mappings:
      - type: custom

  has_diabetes:
    type: bool
    mappings:
      - type: custom

  previous_retinal_detachment:
    type: bool
    mappings:
      - type: custom

  only_functional_eye:
    type: bool
    mappings:
      - type: custom

  bilateral_symptoms:
    type: bool
    mappings:
      - type: custom

  is_pregnant:
    type: bool
    mappings:
      - type: custom

  immunocompromised:
    type: bool
    mappings:
      - type: custom

  triage_protocol:
    type: text
    mappings:
      - type: custom

  triage_report:
    type: text
    mappings:
      - type: custom

forms:
  booking_form:
    required_slots:
      - patient_name
      - patient_concern
      - phone_number
      - preferred_time
  
  symptom_form:
    required_slots:
      - patient_concern
      - symptom_duration
      - symptom_severity

  symptom_qualifier_form:
    required_slots:
      - symptom_type
      - symptom_duration
      - symptom_severity
      - affects_daily_life

responses:
  utter_greet:
    - text: "Salam! Briz-L GÃ¶z KlinikasÄ±na xoÅŸ gÉ™lmisiniz. GÃ¶z saÄŸlamlÄ±ÄŸÄ±nÄ±zla baÄŸlÄ± sizÉ™ necÉ™ kÃ¶mÉ™k edÉ™ bilÉ™rÉ™m?"
      metadata:
        language: az
    - text: "Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹Ñ‚Ğµ! Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² Ğ³Ğ»Ğ°Ğ·Ğ½ÑƒÑ ĞºĞ»Ğ¸Ğ½Ğ¸ĞºÑƒ Briz-L. Ğ§ĞµĞ¼ Ğ¼Ğ¾Ğ³Ñƒ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‡ÑŒ?"
      metadata:
        language: ru
    - text: "Hello! Welcome to Briz-L Eye Clinic. How can I help you?"
      metadata:
        language: en

  utter_goodbye:
    - text: "SaÄŸ olun! SizÉ™ cansaÄŸlÄ±ÄŸÄ± arzulayÄ±rÄ±q."

  utter_thanks:
    - text: "Buyurun, borcumuzdur."

  utter_default:
    - text: "BaÄŸÄ±ÅŸlayÄ±n, sizi tam baÅŸa dÃ¼ÅŸmÉ™dim. ZÉ™hmÉ™t olmasa fikrinizi bir az daha É™traflÄ± izah edÉ™ bilÉ™rsiniz?"

  utter_symptom_acknowledged:
    - text: "BaÅŸa dÃ¼ÅŸÃ¼rÉ™m. GÃ¶z saÄŸlamlÄ±ÄŸÄ± Ã§ox vacibdir."

  utter_ask_patient_concern:
    - text: "HansÄ± problemlÉ™ baÄŸlÄ± mÃ¼raciÉ™t edirsiniz? (MÉ™sÉ™lÉ™n: gÃ¶zÃ¼m aÄŸrÄ±yÄ±r, mÃ¼ayinÉ™ lazÄ±mdÄ±r)"

  utter_ask_phone_number:
    - text: "SizinlÉ™ É™laqÉ™ saxlamaÄŸÄ±mÄ±z Ã¼Ã§Ã¼n zÉ™hmÉ™t olmasa telefon nÃ¶mrÉ™nizi qeyd edin. (MÉ™s: 055 123 45 67)"

  utter_ask_preferred_time:
    - text: "MÃ¼ayinÉ™ Ã¼Ã§Ã¼n hansÄ± vaxt sizin Ã¼Ã§Ã¼n uyÄŸundur? (MÉ™s: bu gÃ¼n, sabah sÉ™hÉ™r, hÉ™ftÉ™ sonu)"

  utter_ask_symptom_duration:
    - text: "Bu problem nÉ™ vaxtdan baÅŸlayÄ±b? (MÉ™s: 3 gÃ¼ndÃ¼r, dÃ¼nÉ™ndÉ™n)"

  utter_ask_symptom_severity:
    - text: "AÄŸrÄ± vÉ™ ya narahatlÄ±q nÉ™ dÉ™rÉ™cÉ™dÉ™dir? (MÉ™s: dÃ¶zÃ¼lmÉ™zdir, azdÄ±r, yalnÄ±z axÅŸamlar)"

  utter_booking_confirmed:
    - text: |
        TÉ™ÅŸÉ™kkÃ¼r edirÉ™m! MÉ™lumatlarÄ±nÄ±zÄ± qeyd etdim:
        
        ğŸ“ Problem: {patient_concern}
        ğŸ“ ÆlaqÉ™: {phone_number}
        ğŸ“… Zaman: {preferred_time}
        
        Koordinatorumuz 30 dÉ™qiqÉ™ É™rzindÉ™ sizinlÉ™ É™laqÉ™ saxlayÄ±b vaxtÄ± dÉ™qiqlÉ™ÅŸdirÉ™cÉ™k.

  utter_symptom_analysis:
    - text: |
        MÉ™lumat Ã¼Ã§Ã¼n tÉ™ÅŸÉ™kkÃ¼rlÉ™r. Sizin ÅŸikayÉ™tlÉ™riniz:
        - {patient_concern}
        - MÃ¼ddÉ™t: {symptom_duration}
        
        TÃ¶vsiyÉ™ edirik ki, hÉ™kim mÃ¼ayinÉ™sindÉ™n keÃ§É™siniz. Qeydiyyat edÉ™k?

  utter_booking_info:
    - text: "MÃ¼ayinÉ™yÉ™ yazÄ±lmaq Ã¼Ã§Ã¼n zÉ™hmÉ™t olmasa adÄ±nÄ±zÄ± vÉ™ É™laqÉ™ nÃ¶mrÉ™nizi qeyd edin, koordinatorumuz sizinlÉ™ É™laqÉ™ saxlayacaq."

  utter_doctors_info:
    - text: "Bizim klinikada tÉ™crÃ¼bÉ™li oftalmoloqlar fÉ™aliyyÉ™t gÃ¶stÉ™rir. Dr. Ä°ltifat ÅÉ™rif, Dr. Emil QafarlÄ±, Dr. SÉ™binÉ™ Æbiyeva vÉ™ Dr. Seymur Bayramov."

  utter_price_estimate:
    - text: "QiymÉ™tlÉ™r mÃ¼ayinÉ™ nÉ™ticÉ™sindÉ™n asÄ±lÄ±dÄ±r. MÉ™sÉ™lÉ™n, É™n sadÉ™ mÃ¼ayinÉ™ 30-50 AZN, É™mÉ™liyyatlar isÉ™ fÉ™rqlidir. DÉ™qiq qiymÉ™t hÉ™kim baxÄ±ÅŸÄ±ndan sonra bilinir."

  utter_emergency_protocol:
    - text: "âš ï¸ TÉ™cili vÉ™ziyyÉ™t protokolu aktivlÉ™ÅŸdi. ZÉ™hmÉ™t olmasa dÉ™rhal +994 12 541 19 00 nÃ¶mrÉ™sinÉ™ zÉ™ng edin."

  utter_urgent_booking_offer:
    - text: "Sizin vÉ™ziyyÉ™tiniz tÉ™cilidir. Sabah Ã¼Ã§Ã¼n boÅŸ yerimiz var, sizi yazÄ±m?"

  utter_ask_affects_daily_life:
    - text: "Bu problem gÃ¼ndÉ™lik hÉ™yatÄ±nÄ±za mane olurmu? (iÅŸlÉ™mÉ™k, oxumaq, maÅŸÄ±n sÃ¼rmÉ™k)"

  utter_ask_symptom_type:
    - text: "ZÉ™hmÉ™t olmasa ÅŸikayÉ™tinizi qÄ±saca tÉ™svir edin."

  utter_acknowledge_pain:
    - text: "BaÅŸa dÃ¼ÅŸÃ¼rÉ™m, gÃ¶z aÄŸrÄ±sÄ± hÉ™qiqÉ™tÉ™n narahat edicidir. HeÃ§ kim aÄŸrÄ± ilÉ™ yaÅŸamalÄ± deyil."
    - text: "GÃ¶z aÄŸrÄ±nÄ±zÄ±n olmasÄ± Ã§ox É™ziyyÉ™tlidir. GÉ™lin tez hÉ™ll tapaq."

  utter_acknowledge_worry:
    - text: "GÃ¶rmÉ™ problemlÉ™ri tÉ™bii ki narahat edir. Amma yaxÅŸÄ± xÉ™bÉ™r - É™ksÉ™r gÃ¶z problemlÉ™ri mÃ¼alicÉ™ olunandÄ±r."
    - text: "NarahatÃ§Ä±lÄ±ÄŸÄ±nÄ±zÄ± baÅŸa dÃ¼ÅŸÃ¼rÉ™m. GÃ¶z saÄŸlamlÄ±ÄŸÄ± Ã§ox vacibdir vÉ™ biz kÃ¶mÉ™yÉ™ hazÄ±rÄ±q."

  utter_acknowledge_fear:
    - text: "Qorxmaq normaldÄ±r. Amma bilmÉ™lisiniz ki, gÃ¶z É™mÉ™liyyatlarÄ± Ã§ox inkiÅŸaf edib vÉ™ tÉ™hlÃ¼kÉ™sizdir."
    - text: "Bu narahatlÄ±q hiss edirsiniz, anlayÄ±ram. SizinlÉ™ addÄ±m-addÄ±m gedÉ™cÉ™yik vÉ™ hÉ™r ÅŸeyi izah edÉ™cÉ™yik."

  utter_acknowledge_urgency:
    - text: "TÉ™cili vÉ™ziyyÉ™t olduÄŸunu gÃ¶rÃ¼rÉ™m. DÉ™rhal kÃ¶mÉ™k edÉ™k."
    - text: "Bunu ciddi qÉ™bul edirÉ™m. Ä°ndi sadÉ™ dildÉ™ izah edim."

  utter_acknowledge_frustration:
    - text: "GÃ¶rÃ¼rÉ™m ki É™sÉ™bisiniz. Ãœzr istÉ™yirÉ™m, gÉ™lin daha aydÄ±n izah edim."
    - text: "BilirÉ™m, Ã§aÅŸqÄ±n hiss edirsiniz. Ä°ndi sadÉ™ dildÉ™ izah edim."

  utter_reassure_pain_management:
    - text: |
        ğŸ’™ AÄŸrÄ±dan qorxmayÄ±n - mÃ¼asir gÃ¶z É™mÉ™liyyatlarÄ± aÄŸrÄ±sÄ±zdÄ±r.
        
        NecÉ™?
        âœ… Lokal anesteziya damcÄ±sÄ±
        âœ… HeÃ§ nÉ™ hiss etmÉ™zsiniz
        âœ… SadÉ™cÉ™ yÃ¼ngÃ¼l tÉ™zyiq
        âœ… ÆmÉ™liyyat 10-20 dÉ™qiqÉ™
        
        ÆmÉ™liyyatdan SONRA:
        â€¢ Ä°lk saatlar: yÃ¼ngÃ¼l narahatlÄ±q (normal)
        â€¢ AÄŸrÄ±kÉ™sici damcÄ± veririk
        â€¢ 24 saatda rahatsÄ±nÄ±z
        
        PasiyentlÉ™rimiz deyir: "GÃ¶zlÉ™diyimdÉ™n asan oldu"
        
        Bu mÉ™lumat sizi sakitlÉ™ÅŸdirdimi?


  utter_address_info:
    - text: "KlinikamÄ±z BakÄ± ÅŸÉ™hÉ™ri, AzadlÄ±q prospekti 124 Ã¼nvanÄ±nda yerlÉ™ÅŸir. (BakÄ± SaÄŸlamlÄ±q MÉ™rkÉ™zi ilÉ™ Ã¼zbÉ™Ã¼z)"
      metadata:
        language: az
    - text: "ĞĞ°ÑˆĞ° ĞºĞ»Ğ¸Ğ½Ğ¸ĞºĞ° Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑÑ Ğ² Ğ‘Ğ°ĞºÑƒ, Ğ¿Ñ€Ğ¾ÑĞ¿ĞµĞºÑ‚ ĞĞ·Ğ°Ğ´Ğ»Ñ‹Ğ³ 124. (ĞĞ°Ğ¿Ñ€Ğ¾Ñ‚Ğ¸Ğ² Ğ‘Ğ°ĞºĞ¸Ğ½ÑĞºĞ¾Ğ³Ğ¾ ĞĞ·Ğ´Ğ¾Ñ€Ğ¾Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¦ĞµĞ½Ñ‚Ñ€Ğ°)"
      metadata:
        language: ru
    - text: "Our clinic is located at 124 Azadlig Avenue, Baku. (Opposite Baku Health Center)"
      metadata:
        language: en

  utter_hours_info:
    - text: "Ä°ÅŸ saatlarÄ±mÄ±z: Bazar ertÉ™si - ÅÉ™nbÉ™, 09:00 - 18:00. Bazar gÃ¼nÃ¼ istirahÉ™t gÃ¼nÃ¼dÃ¼r."
      metadata:
        language: az
    - text: "Ğ§Ğ°ÑÑ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹: ĞŸĞ¾Ğ½ĞµĞ´ĞµĞ»ÑŒĞ½Ğ¸Ğº - Ğ¡ÑƒĞ±Ğ±Ğ¾Ñ‚Ğ°, 09:00 - 18:00. Ğ’Ğ¾ÑĞºÑ€ĞµÑĞµĞ½ÑŒĞµ - Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ½Ğ¾Ğ¹."
      metadata:
        language: ru
    - text: "Working hours: Monday - Saturday, 09:00 AM - 06:00 PM. Sunday is a day off."
      metadata:
        language: en

  utter_bot_help:
    - text: |
        MÉ™n sizÉ™ aÅŸaÄŸÄ±dakÄ± mÃ¶vzularda kÃ¶mÉ™k edÉ™ bilÉ™rÉ™m:
        ğŸ”¹ GÃ¶z xÉ™stÉ™liklÉ™ri haqqÄ±nda mÉ™lumat (mÉ™s: katarakta nÉ™dir?)
        ğŸ”¹ MÃ¼ayinÉ™yÉ™ yazÄ±lmaq
        ğŸ”¹ HÉ™kim seÃ§imi (mÉ™s: hansÄ± hÉ™kim yaxÅŸÄ±dÄ±r?)
        ğŸ”¹ QiymÉ™tlÉ™r
        ğŸ”¹ Ãœnvan vÉ™ iÅŸ saatlarÄ±
        
        NÉ™ ilÉ™ maraqlanÄ±rsÄ±nÄ±z?
      metadata:
        language: az
    - text: |
        Ğ¯ Ğ¼Ğ¾Ğ³Ñƒ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‡ÑŒ Ğ²Ğ°Ğ¼ ÑĞ¾ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¼Ğ¸ Ñ‚ĞµĞ¼Ğ°Ğ¼Ğ¸:
        ğŸ”¹ Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ³Ğ»Ğ°Ğ·Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ±Ğ¾Ğ»ĞµĞ²Ğ°Ğ½Ğ¸ÑÑ… (Ğ½Ğ°Ğ¿Ñ€: Ñ‡Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ ĞºĞ°Ñ‚Ğ°Ñ€Ğ°ĞºÑ‚Ğ°?)
        ğŸ”¹ Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ Ğ½Ğ° Ğ¿Ñ€Ğ¸ĞµĞ¼
        ğŸ”¹ Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ²Ñ€Ğ°Ñ‡Ğ° (Ğ½Ğ°Ğ¿Ñ€: ĞºĞ°ĞºĞ¾Ğ¹ Ğ²Ñ€Ğ°Ñ‡ Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¸Ğ¹?)
        ğŸ”¹ Ğ¦ĞµĞ½Ñ‹
        ğŸ”¹ ĞĞ´Ñ€ĞµÑ Ğ¸ Ñ‡Ğ°ÑÑ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹
        
        Ğ§Ñ‚Ğ¾ Ğ²Ğ°Ñ Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑÑƒĞµÑ‚?
      metadata:
        language: ru
    - text: |
        I can help you with the following topics:
        ğŸ”¹ Information about eye conditions (e.g., what is a cataract?)
        ğŸ”¹ Booking an appointment
        ğŸ”¹ Choosing a doctor (e.g., who is the best doctor?)
        ğŸ”¹ Pricing
        ğŸ”¹ Address and working hours
        
        What are you interested in?
      metadata:
        language: en

  utter_social_reply:
    - text: "Ã‡ox saÄŸ olun, mÉ™n yaxÅŸÄ±yam! SizÉ™ necÉ™ kÃ¶mÉ™k edÉ™ bilÉ™rÉ™m?"
      metadata:
        language: az
    - text: "Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾, Ñƒ Ğ¼ĞµĞ½Ñ Ğ²ÑĞµ Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¾! Ğ§ĞµĞ¼ Ñ Ğ¼Ğ¾Ğ³Ñƒ Ğ²Ğ°Ğ¼ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‡ÑŒ?"
      metadata:
        language: ru
    - text: "I'm doing great, thank you! How can I help you today?"
      metadata:
        language: en

  utter_hitl:
    - text: |
        SizÉ™ daha yaxÅŸÄ± kÃ¶mÉ™k etmÉ™k Ã¼Ã§Ã¼n zÉ™hmÉ™t olmasa koordinatorumuzla birbaÅŸa WhatsApp vasitÉ™silÉ™ É™laqÉ™ saxlayÄ±n:

        https://wa.me/994555512400

        Koordinatorumuz bÃ¼tÃ¼n suallarÄ±nÄ±zÄ± cavablandÄ±racaq.

actions:
  - action_guardrail_language
  - action_fallback_with_count
  - action_analyze_symptoms
  - action_recommend_doctor
  - action_detect_emotion
  - action_adaptive_response
  - action_triage_patient
  - validate_symptom_qualifier_form
  - action_provide_reassurance
  - action_detect_language
  - action_adaptive_utter
  - action_progressive_education
  - action_recap_conversation
  - action_smart_follow_up
  - action_build_patient_profile
  - action_warm_handoff
  - action_recognize_returning_patient
  - action_educate
  - action_search_education
  - action_list_conditions

